#include<stdio.h>
#include<stdlib.h>
/********************************************************************************************************************************************/
/*                                                                                                                                          */
/***************************************************____Les listes simplement chaînées____***************************************************/
/*                                                                                                                                          */
/*                                                                                                                                          */
//	La déclaration d'une liste simplement chaînée d'entiers :
//____________________________________________________________________________________________________________________________________________
 struct element
  {
  	int v;
  	struct element *nxt;
  };
 typedef struct element element;
 typedef element *list;
//_____________________________________________________________________________________________________________________________________________
//	Ajouter en Element tête :
//_____________________________________________________________________________________________________________________________________________
 list ajouter_en_tete(list l,int n)
  {
 	list lp=(list)malloc(sizeof(element));
 	lp->v=n;
 	lp->nxt=l;
 	return lp;
  }
//_____________________________________________________________________________________________________________________________________________
//	Ajouter Element en fin :
//_____________________________________________________________________________________________________________________________________________
 list ajouter_en_fin(list l,int n)
  {
 	list tmp;
	list lp=(list)malloc(sizeof(element));
 	lp->v=n;
	lp->nxt=NULL;
	 if(l==NULL)
	return lp;
	 else
	 {
	 	tmp=l;
	 	while(tmp->nxt!=NULL)
	 	 tmp=tmp->nxt;
	 	tmp->nxt=lp;
	 	return l;
	 }	 			
  }
//_____________________________________________________________________________________________________________________________________________
//	Supprimer Element En Tete :
//_____________________________________________________________________________________________________________________________________________ 
 list supprimer_en_tete(list l)
  {
	list lp;
	 if(l==NULL)
	  return NULL;
	 else
	  {
	  	lp=l->nxt;
	  	free(l);
	  	return lp;
	  }
  }
//_____________________________________________________________________________________________________________________________________________   
//	Supprimer Element En Fin :
//_____________________________________________________________________________________________________________________________________________ 
 list supprimer_en_fin(list l)
  {
	list lp1,lp2;
	 if(l==NULL)
	  return NULL;
	 if(l->nxt==NULL)
	 {
	 	free(l);
	 	return NULL;
	 }
	lp1=l;
	 while(lp1->nxt->nxt!=NULL)
	   lp1=lp1->nxt;
	 lp2=lp1->nxt;
	 lp1->nxt=NULL;
	 free(lp2);
	return l;	  	
  }
//_____________________________________________________________________________________________________________________________________________
//	Supprimer Element quelconque dans la liste : 
//_____________________________________________________________________________________________________________________________________________
 list supprimer(list l,int n)
  {
   list lp1,lp2;
    if(l!=NULL)
     if(l->v==n)
      {
       lp1=l;
       l=l->nxt;
       free(lp1);
      }
     else
      {
       lp2=l;
        while(lp2->nxt!=NULL && lp2->nxt->v!=n)
       lp2=lp2->nxt;
      if(lp2->nxt!=NULL)
       {
        lp1=lp2->nxt;
        lp2 ->nxt=lp2->nxt->nxt;
        free(lp1);
       }
      }
    return l;
  }
//_____________________________________________________________________________________________________________________________________________
//	Affichage :
//_____________________________________________________________________________________________________________________________________________
 void affiche_list(list l)
  {
	list tmp=l;
	 while(tmp!=NULL)
	  {
	 	printf("%d\t",tmp->v);
	 	tmp=tmp->nxt;
	  }	
  }
//_____________________________________________________________________________________________________________________________________________
//	Nombre Elements :
//_____________________________________________________________________________________________________________________________________________
 int nb_element(list l)
  {
  	list tmp=l;
  	int nb=0;
  	 if(l==NULL)
  	  return 0;
  	 else
  	  {
  	  	while(tmp!=NULL)
  	  	 {
  	  	 	tmp=tmp->nxt;
  	  	 	nb++;
		 }
	  return nb;
  	  } 	 	 	
  }
//_____________________________________________________________________________________________________________________________________________
//	Nombre Occurences :
//_____________________________________________________________________________________________________________________________________________
 int nb_occurences(list l,int n)
  {
  	list tmp=l;
  	int cpt=0;
  	 if(l==NULL)
  	  return 0;
  	 while(tmp!=NULL)
  	  {
  	  	if(tmp->v==n)
  	  	 cpt++;
  	  	tmp=tmp->nxt;
	  }
	  return cpt;	
  }
//_____________________________________________________________________________________________________________________________________________
//	Supprimer la première occurence :
//_____________________________________________________________________________________________________________________________________________
 list supprimer_premiere_occurence(list l,int n)
  {
  	list lp1,lp2;
  	lp1=l;
  	 if(l==NULL)
  	  return NULL;
  	 if(lp1->v==n)
  	  {
  	  	l=lp1->nxt;
  	  	free(lp1);
  	    return l;
	  }
	 if(lp1->nxt!=NULL)
	  {
	  	lp2=lp1->nxt;
	  	 while(lp2!=NULL && lp2->v!=n)
	  	  {
	  	  	lp1=lp1->nxt;
	  	  	lp2=lp1->nxt;
		  }
		if(lp2!=NULL)
		 {
		 	lp1->nxt=lp2->nxt;
		 	free(lp2);
		 }
		return l;
	  }
  }
//_____________________________________________________________________________________________________________________________________________
//	Supprimer aprés la première occurence :
//_____________________________________________________________________________________________________________________________________________ 
//?????????????????????????????????????????????????????????????
//_____________________________________________________________________________________________________________________________________________ 
//	Supprimer avant le dernier occurence :
//_____________________________________________________________________________________________________________________________________________
//??????????????????????????????????????????????????????????????
//_____________________________________________________________________________________________________________________________________________
//	Supprimer le dernier occurence :
//_____________________________________________________________________________________________________________________________________________
//??????????????????????????????????????????????????????????????
//_____________________________________________________________________________________________________________________________________________
//	Supprimer toute les occurences :
//_____________________________________________________________________________________________________________________________________________
 list supprimer_toute_occurences(list l,int n)
  {
  	list lp1,lp2,lp3;
  	lp1=l;
  	 if(l==NULL)
  	  return NULL;
  	 while(lp1!=NULL && lp1->v==n)
  	  {
  	  	lp2=lp1;
  	  	lp1=lp1->nxt;
  	  	free(lp2);
	  }
	l=lp1;
	 if(l==NULL || l->nxt==NULL)
	  return l;
	lp3=lp1->nxt;
	 while(lp3!=NULL)
	  {
	  	if(lp3->v==n)
	  	 {
	  	 	lp1->nxt=lp3->nxt;
	  	 	free(lp3);
		 }
		else
		 lp1=lp1->nxt,
		lp3=lp1->nxt;  
	  }
	 return l;  
  }
//_____________________________________________________________________________________________________________________________________________
//	Supprimer les double :
//_____________________________________________________________________________________________________________________________________________
 list supprimer_double(list l)
  {
	list ln,l2,l3;
	ln=l;
	while(ln!=NULL)
	{
		l2=ln;
		l3=ln->nxt;
		while(l3!=NULL)
		{
			if(l3->v==ln->v)
			{
				l2->nxt=l3->nxt;
				free(l3);
				l3=l2->nxt;
			}
			else{
				l2=l3;
				l3=l3->nxt;
			}
		}
		ln=ln->nxt;
	}
	return l;
  }
//_____________________________________________________________________________________________________________________________________________
//	Minimum d'une liste chaînée :
//_____________________________________________________________________________________________________________________________________________
 int Minimum(list l)
  {
	int min=l->v;
	while(l!=NULL)
	{
		if(l->v < min)
			min=l->v;
		l=l->nxt;
	}
	return min;
  }
//_____________________________________________________________________________________________________________________________________________
//	Maximum d'une liste chaînée :
//_____________________________________________________________________________________________________________________________________________
 int Maximum(list l)
  {
	int max=l->v;
	while(l!=NULL)
	{
		if(l->v > max)
			max=l->v;
		l=l->nxt;
	}
	return max;
  }
//_____________________________________________________________________________________________________________________________________________
//	Maximum/Minimum d'une liste chaînée :
//_____________________________________________________________________________________________________________________________________________
 void max_min(list l,int *max,int *min)
  {
  	list tmp=l;
  	*max=tmp->v;
  	*min=tmp->v;
  	 while(tmp!=NULL)
  	  {
  	  	if(tmp->v>*max)
  	  	 *max=tmp->v;
  	  	if(tmp->v<*min)
  	  	 *min=tmp->v;
  	  	tmp=tmp->nxt;
      }
  }
//_____________________________________________________________________________________________________________________________________________
//	Inverse une liste chaînée :
//_____________________________________________________________________________________________________________________________________________
 list inverse_list(list l)
  {
  	list nl=NULL;
  	list tmp=l;
  	 while(tmp!=NULL)
  	  {
  	  	nl=ajouter_en_tete(nl,tmp->v);
  	  	tmp=tmp->nxt;
  	  }
  	 return nl;
  }
//_____________________________________________________________________________________________________________________________________________
//	Copie une liste chaînée : 
//_____________________________________________________________________________________________________________________________________________ 
 list copie_list(list l)
  {
  	list nl=NULL;
  	list tmp=l;
  	 while(tmp!=NULL)
  	  {
  	  	nl=ajouter_en_fin(nl,tmp->v);
  	  	tmp=tmp->nxt;
  	  }
  	 return nl;
  }
//_____________________________________________________________________________________________________________________________________________
//	Tester si une liste chaînée est triée : 
//_____________________________________________________________________________________________________________________________________________
 int Test_trie(list l)
  {
    while(l->nxt!=NULL)
	 {
		if(l->v>l->nxt->v)
			return 0;
		l=l->nxt;
	 }
    return 1;
  }
//_____________________________________________________________________________________________________________________________________________
//	Ajouter Elément dans une liste chainée triée :
//_____________________________________________________________________________________________________________________________________________
 list ajouter_trie(list l,int n)
  {
	list l2,l3,ln=(element *)malloc(sizeof(element));
	ln->v=n;
	ln->nxt=NULL;
	
	if(l==NULL)
		return ln;
	if(l->v >= n)
	{
		ln->nxt=l;
		return ln;
	}
	l2=l;
	l3=l->nxt;
	while(l3!= NULL)
	{
		if(l3->v >= n)
		{
			l2->nxt=ln;
			ln->nxt=l3;
			return l;
		}
		l2=l3;
		l3=l3->nxt;
	}
	l2->nxt=ln;
	return l;
  }
//_____________________________________________________________________________________________________________________________________________
//	Tri simple une liste chainée :
//_____________________________________________________________________________________________________________________________________________
 list tri_simple(list l)
  {
	list nl=NULL;
	int min;
	while(l!=NULL)
	  {
		min=Minimum(l);
		nl=ajouter_en_fin(nl,min);
		l=supprimer(l,min);
	  }
	return nl;
  }
//_____________________________________________________________________________________________________________________________________________
//	Tri une liste chainée :
//_____________________________________________________________________________________________________________________________________________
 list tri(list l)
  {
	list l2,l3;
	int min;
	if(l==NULL || l->nxt==NULL)
		return l;
	min=Minimum(l);
	if(l->v==min )
		l->nxt=tri(l->nxt);
	else{
		l2=l;
		l3=l->nxt;
		while(l3!=NULL)
		{
			if(l3->v==min)
			{
				l2->nxt=l3->nxt;
				l3->nxt=l;
				l=l3;
				break;	
			}
			l2=l3;
			l3=l3->nxt;
		}
		l->nxt=tri(l->nxt);
	}
	return l;
  }
//_____________________________________________________________________________________________________________________________________________
//	Fusionner deux listes chainée(Destructrice) :
//_____________________________________________________________________________________________________________________________________________
 list concat_list_destructrice(list l1,list l2)
  {
  	list tmp=l1;
  	if(l1==NULL)
  	 return l2;
  	if(l2==NULL)
  	 return l1;
  	while(tmp->nxt!=NULL)
  	 tmp=tmp->nxt;
  	tmp->nxt=l2;
  	return l1;
  }
//_____________________________________________________________________________________________________________________________________________
//	Fusionner deux listes chainée(non Destructrice) :
//_____________________________________________________________________________________________________________________________________________
 list concat_list_non_destructrice(list l1,list l2)
  {
  	list tmp;
  	list l=NULL;
  	tmp=l1;
  	 while(tmp!=NULL)
  	  {
  	  	l=ajouter_en_fin(l,tmp->v);
  	  	tmp=tmp->nxt;
	  }
	tmp=l2;
	 while(tmp!=NULL)
  	  {
  	  	l=ajouter_en_fin(l,tmp->v);
  	  	tmp=tmp->nxt;
	  }
	return l;	 
  }
//_____________________________________________________________________________________________________________________________________________ 
//	Fusionner deux listes chainée trié :
//_____________________________________________________________________________________________________________________________________________
 list Fusion(list l1,list l2)
  {
	list nl=NULL;
	while(l1 != NULL && l2 != NULL)
	{
		if((l1->v) > (l2->v))
		{
			nl=ajouter_en_fin(nl,l2->v);
			l2=l2->nxt;
		}
		else
		{
			nl=ajouter_en_fin(nl,l1->v);
			l1=l1->nxt;
		}
	}
	while(l1 != NULL) 
	{
		nl=ajouter_en_fin(nl,l1->v);
		l1=l1->nxt;
	}
	while(l2 != NULL) 
	{
		nl=ajouter_en_fin(nl,l2->v);
		l2=l2->nxt;
	}
	return nl;
  }
//_____________________________________________________________________________________________________________________________________________ 
/*********************************************************************************************************************************************/

