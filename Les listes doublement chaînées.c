#include<stdio.h>
#include<stdlib.h>
#include<string.h>
/*********************************************************************************************************************************************/
/*                                                                                                                                           */  
/***************************************************____Les listes doublement chaînées____****************************************************/
/*                                                                                                                                           */
/*                                                                                                                                           */
//La déclaration d'une liste doublement chaînée  d'entiers :
//_____________________________________________________________________________________________________________________________________________ 
 typedef struct cellule
  {
  	int v;
  	struct cellule *prd;
  	struct cellule *nxt;
  }cellule,*llist;
//_____________________________________________________________________________________________________________________________________________
//Fonction 1: Insere en tete : 
//_____________________________________________________________________________________________________________________________________________
 llist insere_en_tete(llist d,int n) 
  {
 	llist nd=(llist)malloc(sizeof(cellule));
 	nd->v=n;
 	nd->nxt=d;
 	nd->prd=NULL;
 	 if(d!=NULL)
 	  d->prd=nd;
 	return nd;
  }
//______________________________________________________________________________________________________________________________________________
//Fonction 2: Insere en fin :
//______________________________________________________________________________________________________________________________________________
 llist insere_en_fin(llist d,int n)
  {
  	llist tmp=d;
  	llist nd=(llist)malloc(sizeof(cellule));
 	nd->v=n;
 	nd->nxt=NULL;
	 if(d==NULL)
	  {
	  	nd->prd=NULL;
	  	return nd;
	  }
	 else
	  {
	  	while(tmp->nxt!=NULL)
	  	 tmp=tmp->nxt;
	  	tmp->nxt=nd;
	  	nd->prd=tmp;
	  }
	return d; 
  }
//______________________________________________________________________________________________________________________________________________
//Fonction 3: Supprimer Cellule En Tete :
//______________________________________________________________________________________________________________________________________________
//????????????????????????????????????????????????????



//______________________________________________________________________________________________________________________________________________
//Fonction 4: Supprimer Cellule En fin :
//______________________________________________________________________________________________________________________________________________
//????????????????????????????????????????????????????




//_____________________________________________________________________________________________________________________________________________
//Fonction 5: Supprimer Cellule quelconque dans la liste :
//_____________________________________________________________________________________________________________________________________________
//?????????????????????????????????????????????????????




//_____________________________________________________________________________________________________________________________________________
//Fonction 6: Affichage :
//_____________________________________________________________________________________________________________________________________________
 void affiche_llist(llist l)
  {
	llist tmp=l;
	 while(tmp!=NULL)
	  {
	 	printf("%d\t",tmp->v);
	 	tmp=tmp->nxt;
	  }	
  }
//_____________________________________________________________________________________________________________________________________________
//fonction 7: Nombre Cellule :
//_____________________________________________________________________________________________________________________________________________
 int nb_element_llist(llist l)
  {
  	llist tmp=l;
  	int nb=0;
  	 if(l==NULL)
  	  return 0;
  	 else
  	  {
  	  	while(tmp!=NULL)
  	  	 {
  	  	 	tmp=tmp->nxt;
  	  	 	nb++;
		 }
	  return nb;
  	  } 	 	 	
  }
//_____________________________________________________________________________________________________________________________________________
//Fonction 8: Nombre Occurences : 
//_____________________________________________________________________________________________________________________________________________
 int nb_occurences_llist(llist l,int n)
  {
  	llist tmp=l;
  	int cpt=0;
  	 if(l==NULL)
  	  return 0;
  	 while(tmp!=NULL)
  	  {
  	  	if(tmp->v==n)
  	  	 cpt++;
  	  	tmp=tmp->nxt;
	  }
	  return cpt;	
  }
//_____________________________________________________________________________________________________________________________________________
//Fonction 9: Supprimer la première occurence :
//_____________________________________________________________________________________________________________________________________________
 llist sup_p_occ_llist(llist l,int n)
  {
  	llist lp1,lp2,lp3;
  	lp1=l;
  	 if(lp1==NULL)
  	  return NULL;
  	 while(lp1!=NULL && lp1->v!=n)
  	  lp1=lp1->nxt;
  	 if(lp1!=NULL)
  	  {
  	  	lp2=lp1->prd;
  	  	lp3=lp1->nxt;
  	  	free(lp1);
  	  	 if(lp3!=NULL)
  	  	  lp3->prd=lp2;
  	  	 if(lp2!=NULL)
  	  	  lp2->nxt=lp3;
  	  	 else
  	  	 return lp3;
  	  }
  	return l;
  }
//_____________________________________________________________________________________________________________________________________________
//Fonction 10: Supprimer aprés la première occurence :
//_____________________________________________________________________________________________________________________________________________
//????????????????????????????????????????????????????????




//_____________________________________________________________________________________________________________________________________________
//Fonction 11: Supprimer avant le dernier occurence : 
//_____________________________________________________________________________________________________________________________________________
 llist sup_ad_occ_llist(llist l,int n)
  {
  	llist lp1,lp2,lp3;
  	int cpt=0;
  	lp1=l;
  	 if(lp1==NULL)
  	  return NULL;
  	 while(lp1->nxt!=NULL)
  	  lp1=lp1->nxt;
  	 while(lp1!=NULL)
  	  {
  	  	if(lp1->v==n && cpt==0)
  	  	 cpt++;
  	  	else
		 if(lp1->v==n && cpt==1)
		  {
		  	lp2=lp1->prd;
			lp3=lp1->nxt;
			free(lp1);
			 if(lp3!=NULL)
			  lp3->prd=lp2;
			 if(lp2!=NULL)
			  lp2->nxt=lp3;
			 else
			 return lp3;
			return l;
		  }
		lp1=lp1->nxt; 
	  }
	return l;
  }
//_____________________________________________________________________________________________________________________________________________
//Fonction 12: Supprimer le dernier occurence :
//_____________________________________________________________________________________________________________________________________________
 llist suo_d_occ_llist(llist l,int n)
  {
  	llist lp1,lp2,lp3;
  	lp1=l;
  	 if(lp1==NULL)
  	  return NULL;
  	 while(lp1->nxt!=NULL)
  	  lp1=lp1->nxt;
  	 while(lp1!=NULL && lp1->v!=n)
  	  lp1=lp1->prd;
  	 if(lp1!=NULL)
  	  {
  	  	lp2=lp1->prd;
  	  	lp3=lp1->nxt;
  	  	free(lp1);
  	  if(lp3!=NULL)
  	    lp3->prd=lp2;
  	  if(lp2!=NULL)
  	    lp2->nxt=lp3;
  	  else
  	    return lp3;
  	 }
  	return l;
  }
//_____________________________________________________________________________________________________________________________________________
//Fonction 13; Supprimer toute les occurence :
//_____________________________________________________________________________________________________________________________________________
 llist sup_toute_occ_llist(llist l,int n)
  {
  	llist lp1,lp2,lp3,lp4;
  	lp1=l;
  	 while(lp1==NULL)
  	  return NULL;
  	 while(lp1!=NULL)
  	  {
  	  	if(lp1->v==n)
  	  	 {
  	  	 	lp2=lp1->prd;
  	  	 	lp3=lp1->nxt;
  	  	 	 if(lp3!=NULL)
  	  	 	  lp3->prd=lp2;
  	  	 	 if(lp2!=NULL)
  	  	 	  lp2->nxt=lp3;
  	  	 	 else
  	  	 	  l=lp3;
  	  	 	 lp4=lp1;
  	  	 	 free(lp4);
  	  	 	 lp1=lp3;
		 }
		else
		 lp1=lp1->nxt;
	  }
	return l;

  }
//_____________________________________________________________________________________________________________________________________________
//Fonction 14: Tester si une liste doublement chaînée est triée : 
//_____________________________________________________________________________________________________________________________________________
//?????????????????????????????????????????????????????????????



//_____________________________________________________________________________________________________________________________________________
//Fonction 15:Ajouter Cellule dans une liste doublement chaînée triée :
//_____________________________________________________________________________________________________________________________________________
 llist insere_triee(llist l,int n)
  {
  	llist lp1,lp2;
  	llist nl=(llist)malloc(sizeof(cellule));
  	nl->v=n;
  	 if(l==NULL)
  	  {
  	  	nl->nxt=NULL;
  	  	nl->prd=NULL;
  	  	return nl;
	  }
	 if(l->v>n)
	  {
	  	nl->prd=NULL;
	  	nl->nxt=l;
	  	l->prd=nl;
	  	return nl;
	  }
  	 else
  	  {
  	  	lp1=l;
  	  	lp2=lp1->nxt;
  	  	 while(lp2!=NULL && lp2->v<n)
  	  	  {
  	  	  	lp1=lp2;
  	  	  	lp2=lp2->nxt;
		  }
		 if(lp2==NULL)
		  {
		    lp1->nxt=nl;
		    nl->prd=lp1;
		    nl->nxt=NULL;
		  }
		 else
		  {
		  	lp1->nxt=nl;
		  	nl->prd=lp1;
		  	nl->nxt=lp2;
		  	lp2->prd=nl;
		  }
     return l;
      }
  }
//_____________________________________________________________________________________________________________________________________________
//Fonction 16: Tri une liste doublement chaînée :
//_____________________________________________________________________________________________________________________________________________
//?????????????????????????????????????????????????????????????



//_____________________________________________________________________________________________________________________________________________
//Fonction 17: Fusionner deux listes doublement chaînée (Destructrice) :
//_____________________________________________________________________________________________________________________________________________
 llist concat_llist_destructrice(llist l1,llist l2)
  {
  	llist tmp=l1;
  	if(l1==NULL)
  	 return l2;
  	if(l2==NULL)
  	 return l1;
  	while(tmp->nxt!=NULL)
  	 tmp=tmp->nxt;
  	tmp->nxt=l2;
  	l2->prd=tmp;
  	return l1;
  }
//_____________________________________________________________________________________________________________________________________________
//Fonction 18; Fusionner deux listes doublement chaînée (non Destructrice) :
//_____________________________________________________________________________________________________________________________________________
 llist concat_llist_non_destructrice(llist l1,llist l2)
  {
  	llist tmp;
  	llist l=NULL;
  	tmp=l1;
  	 while(tmp!=NULL)
  	  {
  	  	l=insere_en_fin(l,tmp->v);
  	  	tmp=tmp->nxt;
	  }
	tmp=l2;
	 while(tmp!=NULL)
  	  {
  	  	l=insere_en_fin(l,tmp->v);
  	  	tmp=tmp->nxt;
	  }
	return l;	 
  }
//_____________________________________________________________________________________________________________________________________________ 
//Fonction 19: Inverse une liste doublement chaînée :
//_____________________________________________________________________________________________________________________________________________
 llist inverse_llist(llist l)
  {
  	llist nl=NULL;
  	llist tmp=l;
  	 while(tmp!=NULL)
  	  {
  	  	nl=insere_en_tete(nl,tmp->v);
  	  	tmp=tmp->nxt;
  	  }
  	 return nl;
  }
//_____________________________________________________________________________________________________________________________________________
//Fonction 20; Copie une liste doublement chaînée :
//_____________________________________________________________________________________________________________________________________________
 llist copie_llist(llist l)
  {
  	llist nl=NULL;
  	llist tmp=l;
  	 while(tmp!=NULL)
  	  {
  	  	nl=insere_en_fin(nl,tmp->v);
  	  	tmp=tmp->nxt;
  	  }
  	 return nl;
  }
//_____________________________________________________________________________________________________________________________________________ 
/*********************************************************************************************************************************************/
